<!DOCTYPE html>
<html lang="en">
	<head>
		<!--  Meta  -->
		<meta charset="UTF-8" />
		<title>Recomendación</title>
		<meta name="viewport" content="width=device-width, user-scalable=no">
		<!--  Styles  -->
		<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
		<link rel="stylesheet" href="../../styles.css">
		<link rel="stylesheet" href="../../sport_theme.css">
	</head>
	<body>
		<div class="Container">
			<div class="View">
				<header>
					<a href="../index.html">
						<svg width="50" height="20" viewBox="0 0 50 20" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M21.442 13.283c-1.787.367-1.79 1.503-1.79 1.924 0 .79.4 2.116 3.071 2.116 1.757 0 3.07-1.197 3.07-2.267v-1.478c.001 0-1.671-.949-4.35-.295zm6.658 6.122h-2.306v-1.342c-1.188 1.635-3.768 1.497-4.078 1.474-2.685-.322-4.368-1.948-4.368-4.326 0-2.704 2.01-4.312 5.375-4.312 1.261 0 2.268.14 3.071.423v-.812c.052-1.57-.565-2.015-.769-2.163-1.29-.931-4.104-.262-4.988.045l-.772-2.14a13.512 13.512 0 0 1 2.482-.565c1.965-.252 3.523.025 4.635.824.822.591 1.786 1.774 1.716 4.056l.002 8.838zm-17.558-.014L5.744 11.2l4.423-3.942-1.545-1.684-6.317 5.629V.154H0V19.41h2.305v-5.147l1.691-1.508 3.885 6.632 2.661.003zm33.23-11.596c1.6 0 2.696.6 3.348 1.835.155.297.278.61.368.934h-7.544c.455-1.428 1.495-2.77 3.797-2.77h.03zm4.052 6.888c-1.048 1.87-2.415 2.794-4.064 2.74h-.123c-1.183 0-2.08-.325-2.742-.99-1.081-1.098-1.251-2.835-1.277-3.439H50l-.014-1.154a7.396 7.396 0 0 0-.779-3.015c-.73-1.436-2.266-3.147-5.439-3.147-1.612 0-2.755.492-3.437.906-2.38 1.448-2.954 4.126-3.017 6.117-.005.131-.086 3.255 1.919 5.297 1.103 1.125 2.586 1.694 4.403 1.694h.254c2.425 0 4.533-1.383 5.953-3.915l-2.019-1.094zM37.692 5.782l-.234-.04c-2.269-.356-4.082-.01-5.242.998-.999.868-1.48 2.154-1.428 3.823v8.84h2.304V10.51c-.031-.968.187-1.663.65-2.065.592-.514 1.71-.685 3.163-.485l.787-2.177zM15.238.154h-2.305v19.25h2.305V.155zm-14.062 0h.046-.046z" id="svg3942369641a"></path></defs><g fill="none" fill-rule="evenodd"><mask id="svg3942369641b" fill="#fff"><use xlink:href="#svg3942369641a"></use></mask><g mask="url(#svg3942369641b)" fill="#FFF"><path d="M0 0h50v20H0z"></path></g></g></svg>
					</a>
				</header>
				<div class="InnerContainer">
					<small class="pt-6 text-black-50">Cobertura entregada por CONSORCIO</small>
					<div class="calendarContainer">
                        <form id="goto" action="exclusions.html"></form>
                        <div class="my-3">
                            <h5>Días del seguro</h5>
                            <small class="text-muted">Puedes modificar los días de tu seguro.</small>
                        </div>
                        <div class='calendar'>
                            <div class='month-indicator'>
                                <time datetime='2019-02'>Octubre 2019</time>
                            </div>
                            <div class='day-of-week'>
                                <div>Lu</div>
                                <div>Ma</div>
                                <div>Mi</div>
                                <div>Ju</div>
                                <div>Vi</div>
                                <div>Sa</div>
                                <div>Do</div>
                            </div>
                            <div class='date-grid'>
                                <button class="day day-muted"><time datetime='2019-09-30'>30</time></button>
                                <button class="day"><time datetime='2019-10-01'>1</time></button>
                                <button class="day"><time datetime='2019-10-02'>2</time></button>
                                <button class="day"><time datetime='2019-10-03'>3</time></button>
                                <button class="day"><time datetime='2019-10-04'>4</time></button>
                                <button class="day"><time datetime='2019-10-05'>5</time></button>
                                <button class="day"><time datetime='2019-10-06'>6</time></button>
                                <button class="day"><time datetime='2019-10-07'>7</time></button>
                                <button class="day"><time datetime='2019-10-08'>8</time></button>
                                <button class="day"><time datetime='2019-10-09'>9</time></button>
                                <button class="day"><time datetime='2019-10-10'>10</time></button>
                                <button class="day"><time datetime='2019-10-11'>11</time></button>
                                <button class="day"><time datetime='2019-10-12'>12</time></button>
                                <button class="day"><time datetime='2019-10-13'>13</time></button>
                                <button class="day"><time datetime='2019-10-14'>14</time></button>
                                <button class="day"><time datetime='2019-10-15'>15</time></button>
                                <button class="day"><time datetime='2019-10-16'>16</time></button>
                                <button class="day"><time datetime='2019-10-17'>17</time></button>
                                <button class="day"><time datetime='2019-10-18'>18</time></button>
                                <button class="day"><time datetime='2019-10-19'>19</time></button>
                                <button class="day"><time datetime='2019-10-20'>20</time></button>
                                <button class="day"><time datetime='2019-10-21'>21</time></button>
                                <button class="day"><time datetime='2019-10-22'>22</time></button>
                                <button class="day"><time datetime='2019-10-23'>23</time></button>
                                <button class="day"><time datetime='2019-10-24'>24</time></button>
                                <button class="day"><time datetime='2019-10-25'>25</time></button>
                                <button class="day"><time datetime='2019-10-26'>26</time></button>
                                <button class="day"><time datetime='2019-10-27'>27</time></button>
                                <button class="day"><time datetime='2019-10-28'>28</time></button>
                                <button class="day"><time datetime='2019-10-29'>29</time></button>
                                <button class="day"><time datetime='2019-10-30'>30</time></button>
                                <button class="day"><time datetime='2019-10-31'>31</time></button>
                                <button class="day day-muted"><time datetime='2019-11-01'>1</time></button>
                                <button class="day day-muted"><time datetime='2019-11-02'>2</time></button>
                                <button class="day day-muted"><time datetime='2019-11-03'>3</time></button>
                            </div>
                        </div>
                        <div class="mt-2">
                            <small class="text-black-50">Una vez contratado, podrás modificar el día del seguro hasta 24 hrs antes.</small>
                        </div>
                        <div class="details">
                            <hr>
                            <div class="my-3">
                                <h4>Coberturas</h4>
                                <p>Eventos que cubre tu seguro.</p>
                            </div>
                        </div>
                    </div>

                    <footer class="price">
                        <button class="Button Button__back" type="button" onclick="goBack()"><</button>
                        <div>
                            <div class="clp">2100</div>
                            <div class="uf">(<span class="uf_value">0.90</span> UF)</div>
                        </div>
                        <button class="Button Button__next" id="sendButton" form="goto" type="submit">Siguiente</button>
                        <script>
                            function goBack() {
                                history.back();
                            };
                        </script>
                    </footer>
				</div>
			</div>
		</div>

        <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
        <script>
            function formatearNumero(nStr) {
                nStr += '';
                x = nStr.split('.');
                x1 = x[0];
                x2 = x.length > 1 ? ',' + x[1] : '';
                var rgx = /(\d+)(\d{3})/;
                while (rgx.test(x1)) {
                        x1 = x1.replace(rgx, '$1' + '.' + '$2');
                }
                return x1 + x2;
            }
            var days = sessionStorage.days;
            var weekDays = sessionStorage.weekDays;
            var pricePerDay = sessionStorage.pricePerDay;
            var d = new Date();
            var today = d.getDate();
            console.log("days: " + days);
            console.log("today: " + today);
            if (days) {
                var strno = 2, endno = strno - 1 + Number(days); // 0 based index
                $('.day:gt(' + (strno -1) + '):lt(' + (endno - strno + 1) + ')').addClass('is-selected');
                // $('.day:gt(1):lt(days)').addClass('is-selected');
            } else if (weekDays) {
                $(".day:eq(7)").addClass("is-selected");
                $(".day:eq(14)").addClass("is-selected");
                $(".day:eq(21)").addClass("is-selected");
                $(".day:eq(28)").addClass("is-selected");
                $(".day:eq(4)").addClass("is-selected");
                $(".day:eq(11)").addClass("is-selected");
                $(".day:eq(18)").addClass("is-selected");
                $(".day:eq(25)").addClass("is-selected");
            }
            $(document).ready(function () {
                $('.day').on('click', function(e) {
                    $(this).toggleClass("is-selected");
                    var numDays = $('.is-selected').length;
                    // apply discount
                    var discount = 1;
                    if (numDays == 2) {
                        var discount = 0.73;
                        console.log("discount " + discount);
                    } else if (numDays == 3) {
                        var discount = 0.58;
                        console.log("discount " + discount);
                    } else if (numDays == 4) {
                        var discount = 0.49;
                        console.log("discount " + discount);
                    } else if (numDays == 5) {
                        var discount = 0.43;
                        console.log("discount " + discount);
                    } else if (numDays == 6) {
                        var discount = 0.38;
                        console.log("discount " + discount);
                    } else if (numDays >= 7 && numDays <= 9) {
                        var discount = 0.35;
                        console.log("discount " + discount);
                    } else if (numDays >= 10) {
                        var discount = 0.15;
                        console.log("discount " + discount);
                    } else {
                        console.log("no discount");
                    }
                    var price = pricePerDay*numDays;
                    $(".clp").text(formatearNumero(price));
                    sessionStorage.setItem("finalPrice", price);
                    console.log("updated price: " + formatearNumero(price));
                    var ufValue = Math.round(price/28000 * 100) / 100;
                    $(".uf_value").text(ufValue);
                    e.preventDefault();
                });
                
            });
            var numDays = $('.is-selected').length;
            var price = pricePerDay*numDays;
            $(".clp").text(formatearNumero(price));
            sessionStorage.setItem("finalPrice", price);
            var ufValue = Math.round(price/28000 * 100) / 100;
            $(".uf_value").text(ufValue);
        </script>
	</body>
</html>