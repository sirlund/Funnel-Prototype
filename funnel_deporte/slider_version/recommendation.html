<!DOCTYPE html>
<html lang="en">
	<head>
		<!--  Meta  -->
		<meta charset="UTF-8" />
		<title>Recomendación</title>
		<meta name="viewport" content="width=device-width, user-scalable=no">
		<!--  Styles  -->
		<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
		<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.9.0/slick.min.css"/>
		<link rel="stylesheet" href="../../styles.css">
		<link rel="stylesheet" href="../../sport_theme.css">
	</head>
	<body>
		<div class="Container">
			<div class="View">
				<header>
					<a href="../index.html">
						<svg width="50" height="20" viewBox="0 0 50 20" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M21.442 13.283c-1.787.367-1.79 1.503-1.79 1.924 0 .79.4 2.116 3.071 2.116 1.757 0 3.07-1.197 3.07-2.267v-1.478c.001 0-1.671-.949-4.35-.295zm6.658 6.122h-2.306v-1.342c-1.188 1.635-3.768 1.497-4.078 1.474-2.685-.322-4.368-1.948-4.368-4.326 0-2.704 2.01-4.312 5.375-4.312 1.261 0 2.268.14 3.071.423v-.812c.052-1.57-.565-2.015-.769-2.163-1.29-.931-4.104-.262-4.988.045l-.772-2.14a13.512 13.512 0 0 1 2.482-.565c1.965-.252 3.523.025 4.635.824.822.591 1.786 1.774 1.716 4.056l.002 8.838zm-17.558-.014L5.744 11.2l4.423-3.942-1.545-1.684-6.317 5.629V.154H0V19.41h2.305v-5.147l1.691-1.508 3.885 6.632 2.661.003zm33.23-11.596c1.6 0 2.696.6 3.348 1.835.155.297.278.61.368.934h-7.544c.455-1.428 1.495-2.77 3.797-2.77h.03zm4.052 6.888c-1.048 1.87-2.415 2.794-4.064 2.74h-.123c-1.183 0-2.08-.325-2.742-.99-1.081-1.098-1.251-2.835-1.277-3.439H50l-.014-1.154a7.396 7.396 0 0 0-.779-3.015c-.73-1.436-2.266-3.147-5.439-3.147-1.612 0-2.755.492-3.437.906-2.38 1.448-2.954 4.126-3.017 6.117-.005.131-.086 3.255 1.919 5.297 1.103 1.125 2.586 1.694 4.403 1.694h.254c2.425 0 4.533-1.383 5.953-3.915l-2.019-1.094zM37.692 5.782l-.234-.04c-2.269-.356-4.082-.01-5.242.998-.999.868-1.48 2.154-1.428 3.823v8.84h2.304V10.51c-.031-.968.187-1.663.65-2.065.592-.514 1.71-.685 3.163-.485l.787-2.177zM15.238.154h-2.305v19.25h2.305V.155zm-14.062 0h.046-.046z" id="svg3942369641a"></path></defs><g fill="none" fill-rule="evenodd"><mask id="svg3942369641b" fill="#fff"><use xlink:href="#svg3942369641a"></use></mask><g mask="url(#svg3942369641b)" fill="#FFF"><path d="M0 0h50v20H0z"></path></g></g></svg>
					</a>
				</header>
				<div class="InnerContainer">
					<div class="Total">
						<h3>Seguro para <span class="mySport"></span></h3>
					</div>
					<!-- Cards Slider -->
					<div class="Slider Slider--Cards" data-element="carousel">
						<div class="Card">
							<div class="Card__tag">Más ajustado a ti</div>
							<div class="Card__desc">
								<!-- <img src="../../img/inner_deporte_ajustado.png"/> -->
								<div class="daysCovered daysCovered__base"></div>
								<div class="price">
									<h1 class="priceAmount priceAmount__base"></h1>
									<div class="priceDetails priceDetails__base"></div>
								</div>
								<div class="coverageDetails">
									<div class="mb-3">Reembolso de gastos médicos para todas las lesiones.</div>
									<h6>Además incluye:</h6>
									<div class="coverageList d-flex justify-content-center">
										<div class="coverageList__item">icon</div>
										<div class="coverageList__item">icon</div>
									</div>
									<small class="text-muted">Cobertura entregada por Consorcio</small>
								</div>

							</div>
							<div class="Card__footer">
								<a href="edit.html" class="Button">Configurar este seguro</a>
							</div>
						</div>
						<div class="Card secondCard">
							<div class="Card__tag">Más conveniente</div>
							<div class="Card__desc">
								<!-- <img src="../../img/inner_deporte_ajustado.png"/> -->
								<div class="daysCovered daysCovered__alt">30 días asegurado por</div>
								<div class="price">
									<h1 class="priceAmount priceAmount__alt">27,000</h1>
									<div class="priceDetails priceDetails__alt">$900 por día</div>
								</div>
								<div class="coverageDetails">
									<div class="mb-3">Reembolso de gastos médicos para todas las lesiones.</div>
									<h6>Además incluye:</h6>
									<div class="coverageList d-flex justify-content-center">
										<div class="coverageList__item">icon</div>
										<div class="coverageList__item">icon</div>
									</div>
									<small class="text-muted">Cobertura entregada por Consorcio</small>
								</div>

							</div>
							<div class="Card__footer">
								<a href="edit.html" class="Button">Configurar este seguro</a>
							</div>
						</div>
					</div>

					<div class="mt-3 text-center">
						<button type="button" onclick="goBack()">Volver</button>
						<script>
							function goBack() {
								history.back();
							};
						</script>
					</div>
				</div>
			</div>
		</div>

        <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
		<script type="text/javascript" src="../../scripts/index.js"></script>
		<script src="../../scripts/store.js"></script>
		<script>
			function formatearNumero(nStr) {
                nStr += '';
                x = nStr.split('.');
                x1 = x[0];
                x2 = x.length > 1 ? ',' + x[1] : '';
                var rgx = /(\d+)(\d{3})/;
                while (rgx.test(x1)) {
                        x1 = x1.replace(rgx, '$1' + '.' + '$2');
                }
                return x1 + x2;
            }
			// set vars
			let pricePerDay;
			var sportSelected = sessionStorage.sport;

			// getdays
			let days = getParameterByName('daysSelected');
			// store
			sessionStorage.setItem("days", days);

			// get selected week days
			let searchParams = new URLSearchParams(location.search);
			let weekDays = searchParams.getAll('weekday');
			let weekDaysLength = searchParams.getAll('weekday').length;
			// store
			sessionStorage.setItem("weekDays", weekDays);
			sessionStorage.setItem("weekDaysLength", weekDaysLength);
			//Iterate the search parameters.
			for (let p of searchParams) {
				console.log(p);
			}


			// Apply multipliers
			// Motociclismo
			// Ciclismo
			// Running
			// Trekking
			// Fútbol
			// Tenis
			// Zumba
			// Spinning
			// Pilates
			// Crossfit
			// Entrenamiento con pesos
			// Otros indoor similares
			// Snowboard
			// Ski
			// Surf
			// Buceo
			// Bodyboard
			// Paracaidísmo
			// Parapente

			console.log("sport selected: " + sportSelected)
			if (sportSelected == "Motociclismo") {
				pricePerDay = 4900;
			}
			if (sportSelected == "Ciclismo") {
				pricePerDay = 3700;
			}
			if (sportSelected == "Running") {
				pricePerDay = 2500;
			}
			if (sportSelected == "Trekking") {
				pricePerDay = 3900;
			}
			if (sportSelected == "Fútbol") {
				pricePerDay = 3700;
			}
			if (sportSelected == "Tenis") {
				pricePerDay = 2900;
			}
			if (sportSelected == "Zumba") {
				pricePerDay = 2500;
			}
			if (sportSelected == "Spinning") {
				pricePerDay = 2500;
			}
			if (sportSelected == "Pilates") {
				pricePerDay = 2500;
			}
			if (sportSelected == "Crossfit") {
				pricePerDay = 2500
			}
			if (sportSelected == "Entrenamiento con pesos") {
				pricePerDay = 2500;
			}
			if (sportSelected == "Otros indoor similares") {
				pricePerDay = 2500;
			}
			if (sportSelected == "Snowboard") {
				pricePerDay = 4900;
			}
			if (sportSelected == "Ski") {
				pricePerDay = 4900;
			}
			if (sportSelected == "Buceo") {
				pricePerDay = 3700;
			}
			if (sportSelected == "Surf") {
				pricePerDay = 3700;
			}
			if (sportSelected == "Bodyboard") {
				pricePerDay = 3700;
			}
			if (sportSelected == "Paracaidísmo") {
				pricePerDay = 4700;
			}
			if (sportSelected == "Parapente") {
				pricePerDay = 4700;
			}


			//  Multiply per Day & Print week/single days values
			if (days) {
				var totalDays = days;
				console.log("total days: " + totalDays);
			} else if (weekDays) {
				var totalDays = weekDaysLength*4;
				console.log("weekdays: " + weekDays);
				console.log("weekdayslength: " + weekDaysLength);
				console.log("total days: " + totalDays);
			}

			if (totalDays > 1) {
				$(".daysCovered__base").text(totalDays + " días asegurado por" );
			} else {
				$(".daysCovered__base").text(totalDays + " día asegurado por" );
			}

			var discount = 1;
			// get total price
			if (totalDays == 2) {
				var discount = 0.73;
				console.log("discount " + discount);
			} else if (totalDays == 3) {
				var discount = 0.58;
				console.log("discount " + discount);
			} else if (totalDays == 4) {
				var discount = 0.49;
				console.log("discount " + discount);
			} else if (totalDays == 5) {
				var discount = 0.43;
				console.log("discount " + discount);
			} else if (totalDays == 6) {
				var discount = 0.38;
				console.log("discount " + discount);
			} else if (totalDays >= 7 && totalDays <=9) {
				var discount = 0.35;
				console.log("discount " + discount);
			} else if (totalDays >= 10) {
				var discount = 0.15;
				console.log("discount " + discount);
			} else {
				console.log("no discount");
			}

			pricePerDayAlt = Math.round(pricePerDay*0.13);
			var totalPriceAlt = pricePerDayAlt*30;
			sessionStorage.setItem("pricePerDayAlt", pricePerDayAlt);

			pricePerDay = Math.round(pricePerDay*discount);
			var totalPrice = pricePerDay*totalDays;
			sessionStorage.setItem("pricePerDay", pricePerDay);


			// print priceAmount
			$(".priceAmount__base").text(formatearNumero(totalPrice));
			$(".priceAmount__alt").text(formatearNumero(totalPriceAlt));
			// print priceDetails
			$(".priceDetails__base").text("$" + formatearNumero(pricePerDay) + " por día");
			$(".priceDetails__alt").text("$" + formatearNumero(pricePerDayAlt) + " por día");
			// print sport selected
			$(".mySport").text(sportSelected);

			if (totalDays >= 28) {
				$(".secondCard").remove();
			}

		</script>
		<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
		<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.9.0/slick.min.js"></script>
	</body>
</html>